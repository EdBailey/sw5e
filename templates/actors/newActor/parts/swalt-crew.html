<div class="panel">
    <ul class="filter-list" data-filter="ssactions">
        <li class="filter-title">{{localize "SW5E.Filter"}}</li>
        <li class="filter-item" data-filter="action">{{localize "SW5E.Action"}}</li>
        <li class="filter-item" data-filter="bonus">{{localize "SW5E.BonusAction"}}</li>
        <li class="filter-item" data-filter="reaction">{{localize "SW5E.Reaction"}}</li>
        <li class="filter-item" data-filter="activeDeploy">{{localize "SW5E.FilterActiveDeploy"}}</li>
    </ul>

    <ol class="group-list">
        <li>
            <!-- Deployments (pilot, crew, passenger) -->
            <!-- Only show if there is at least one character on that deployment, or all deployments are being shown -->
            {{#each config.deploymentTypes as | name key |}} {{#with (lookup @root.data.attributes.deployment key) as |
            deployment |}} {{#if (and deployment.items (or deployment.items.length @root.showAllDeployments))}}
            <div class="group-list-title">
                <h3 class="item-name">
                    {{#if (lookup @root.data.attributes.deployment key)}} {{#with (lookup
                    @root.data.attributes.deployment key) as | deployment |}} {{#if deployment.items}} {{localize
                    (lookup @root.config.deploymentTypesPlural key)}} {{else}} {{localize name}} {{/if}} {{/with}}
                    {{else}} {{localize (lookup @root.config.deploymentTypesPlural key)}} {{/if}}
                </h3>
            </div>
            <ol class="group-items item-list">
                {{#each deployment.items as | deploy |}}
                <li
                    class="item group-grid-deployments {{#if (eq deploy @root.data.attributes.deployment.active.value)}}active-deployment{{/if}}"
                    data-key="{{key}}"
                    data-uuid="{{deploy}}"
                >
                    <div class="item-name">
                        <h4>{{ contentLink deploy }}</h4>
                    </div>
                    {{#if (eq key "crew")}}
                    <div class="item-detail item-weight">
                        {{#if (eq deploy @root.data.attributes.deployment.pilot.value)}}
                        <a class="deploy-control pilot" data-action="pilot-toggle">
                            {{localize "SW5E.DeploymentTypePilot"}}
                        </a>
                        {{else if @root.data.attributes.deployment.pilot.value}} {{else}}
                        <a class="deploy-control" data-action="pilot-toggle">
                            {{localize "SW5E.DeploymentTypePilot"}}
                        </a>
                        {{/if}}
                    </div>
                    {{/if}}
                    <div class="item-detail item-controls">
                        {{#if (and @root.owner deploy)}}
                        <a class="deploy-control" data-action="toggle" title="{{localize 'SW5E.DeployToggle'}}">
                            <i class="fas {{#if deploy.active}}fa-check{{else}}fa-times{{/if}}"></i>
                        </a>
                        <a class="deploy-control" data-action="delete" title="{{localize 'SW5E.DeployDelete'}}">
                            <i class="fas fa-trash"></i>
                        </a>
                        {{/if}}
                    </div>
                </li>
                {{/each}}
            </ol>
            {{/if}} {{/with}} {{/each}}

            <!-- Deployment Features -->
            {{#with actions.deploymentfeature as | actions |}} {{#if (not (eq actions.items.length 0))}} {{>
            "systems/sw5e/templates/actors/newActor/parts/swalt-crewactions.html" actions=actions owner=@root.owner
            name=actions.label actor=actor ship=this.actor }} {{/if}} {{/with}}

            <!-- Ventures -->
            {{#with actions.venture as | actions |}} {{#if (not (eq actions.items.length 0))}} {{>
            "systems/sw5e/templates/actors/newActor/parts/swalt-crewactions.html" actions=actions owner=@root.owner
            name=actions.label}} {{/if}} {{/with}}

            <!-- Deployments (pilot, crew, passenger) -->
            <!-- Only show if there is at least one character on that deployment, or all deployments are being shown -->
            {{#each config.deploymentTypes as | name key |}} {{#with (lookup @root.data.attributes.deployment key) as |
            deployment |}} {{#if (and deployment.items (or deployment.items.length @root.showAllDeployments))}}
            <!-- Deployment actions, only show is active character is deployed here, or all actions are being shown -->
            {{#with (lookup @root.actions key) as | actions |}} {{#if (and actions.items.length (or deployment.active
            @root.showAllActions))}} {{> "systems/sw5e/templates/actors/newActor/parts/swalt-crewactions.html"
            actions=actions owner=@root.owner name=name}} {{/if}} {{/with}} {{/if}} {{/with}} {{/each}}
        </li>
    </ol>
</div>
